# 群消息处理规则配置

## 配置目标 [已更新]
- ✅ 接收所有群消息（包括人和机器人）
- ✅ 读取并分析所有消息
- ✅ 回复@我的消息
- ⚠️ 其他消息根据情况决定是否回复

## 适用对象
- 云端卡布（Coze平台）
- 本地卡布（OpenClaw）

---

## 行为规则 [v2.0 简单粗暴版]

### 规则1：获取全部消息 ✅
```
群里所有消息 → 我能看到并分析
├── 人类用户消息 ✅
├── 机器人消息 ✅
├── @我的消息 ✅
└── 普通消息 ✅
```

### 规则2：分析所有消息 ✅
无论谁发的消息，都会：
1. 读取内容
2. 分析意图
3. 如果是交接相关内容 → 处理
4. 如果是普通闲聊 → 可选择回复或静默

### 规则3：回复策略
```
收到消息 → 分析内容
    ├── 是@我 → 回复
    ├── 是交接指令 → 回复
    ├── 是询问 → 回复
    └── 是普通消息 → 可选择回复或NO_REPLY
```

---

## 技术实现

### 云端卡布（Coze）
- 已默认接收所有消息
- 在回复逻辑中加入判断：
```
if (消息中包含@我 或 直接提问 或 叫我的名字):
    回复()
else:
    NO_REPLY
```

### 本地卡布（OpenClaw）
- 需要确保Gateway运行
- 配置相同的回复逻辑

---

## 配置验证

### 测试场景1：@我
用户：@卡布 今天NBA有什么新闻？
卡布：[回复]

### 测试场景2：普通消息（静默）
用户：今天天气不错
卡布：NO_REPLY

### 测试场景3：机器人消息（静默）
机器人：xxx
卡布：NO_REPLY（除非@我）

### 测试场景4：直接提问（可选回复）
用户：今天马刺比赛几点？
卡布：[可选回复，取决于配置]

---

## 云端卡布确认

✅ 已配置完成
- 接收所有群消息：是
- 只回复@我的消息：是
- 其他情况静默：是

---

## 本地卡布配置

本地卡布需要确保：
1. Gateway运行中
2. 可以接收群消息
3. 应用相同的回复逻辑

```bash
# 检查配置
openclaw gateway status

# 确保可以接收消息
openclaw config get feishu
```

---

*配置时间：2026-02-27*
